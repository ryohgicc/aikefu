# AIkeFu Assistant

AIkeFu Assistant 是一个基于AI的智能客服助手Chrome扩展，帮助优化客服回答内容，提供更专业、更友好的客户服务体验。

## 功能特点

- 🤖 **AI智能优化**: 基于火山引擎API智能优化客服回答
- 🌍 **自动语言识别**: AI自动识别用户问题语言，无需手动选择
- ⚙️ **灵活配置**: 可配置的API密钥和模型参数
- 📋 **便捷操作**: 一键复制优化后的回答内容
- 🎯 **用户友好**: 简洁直观的界面设计
- 🔍 **详细调试**: 增强的错误处理和调试信息显示
- 💾 **状态缓存**: 自动保存工作状态，刷新不丢失
- 🎯 **智能内容提取**: 自动识别页面中的用户回复内容
- 💡 **智能回复建议**: 基于内容分析生成个性化回复建议
- ⌨️ **键盘快捷键**: 支持Ctrl+Enter发送，Ctrl+S保存草稿等快捷操作
- 📱 **响应式设计**: 适配不同屏幕尺寸的设备
- 🔒 **SPA支持**: 支持单页应用页面切换检测

## 新增高级功能

### 🎯 智能内容提取
- **目标元素识别**: 自动查找`div.text___1gPRS`等特定类名的回复内容
- **备用提取方案**: 智能识别页面中的反馈、内容、消息等元素
- **内容分析**: 对提取的内容进行情感和类型分析

### 💡 智能回复建议
- **情感分析**: 自动识别正面、负面、中性情感
- **内容分类**: 智能分类为问题、建议、感谢等类型
- **个性化建议**: 基于分析结果生成针对性的回复建议
- **多语言支持**: 根据用户语言偏好生成对应语言的建议

### ⌨️ 键盘快捷键
- **Ctrl/Cmd + Enter**: 快速发送消息
- **Ctrl/Cmd + S**: 手动保存草稿
- **Esc**: 关闭侧边栏（未固定状态下）
- **自动保存**: 每30秒自动保存草稿内容

### 📱 响应式界面
- **全屏模式**: 支持全屏显示，优化大屏幕体验
- **移动适配**: 完美适配手机和平板设备
- **动态布局**: 根据窗口大小自动调整布局

## 安装使用

### 开发模式安装

1. 克隆或下载本项目
2. 打开Chrome浏览器，进入 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"，选择项目文件夹
5. 扩展程序图标将出现在浏览器工具栏

### 配置API

1. 点击扩展程序图标，选择"配置设置"
2. 输入您的火山引擎API密钥、Base URL和模型名称
3. 点击"保存配置"完成设置

## 使用方法

1. **配置API**: 首次使用需配置火山引擎API密钥
2. **自动提取内容**: 扩展会自动检测页面中的用户回复内容
3. **智能分析**: AI分析提取内容的情感和类型
4. **生成建议**: 自动生成个性化的回复建议
5. **优化回答**: 在弹窗界面输入您的回答进行AI优化
6. **复制使用**: 一键复制优化后的回答内容直接使用

### 智能内容提取示例

当检测到页面中有`div.text___1gPRS`元素时：
```
提取的用户回复: "这个功能很好用，但是界面可以更简洁一些"
情感分析: 中性偏正面
内容类型: 建议反馈
智能回复建议: 
1. "感谢您的宝贵建议！我们会认真考虑并在后续版本中优化界面设计。"
2. "很高兴您喜欢这个功能，我们会继续努力改进用户体验。"
```

## 技术架构

- **前端**: HTML5, CSS3, JavaScript ES6+
- **Chrome扩展**: Manifest V3
- **AI服务**: 火山引擎API
- **数据存储**: Chrome Storage API + localStorage
- **内容分析**: 自然语言处理算法

## 文件结构

```
aikefu/
├── manifest.json          # 扩展程序配置文件
├── background.js          # 后台服务脚本
├── popup.html            # 弹窗界面
├── popup.js              # 弹窗交互逻辑
├── popup.css             # 弹窗样式
├── config.html           # 配置页面
├── config.js             # 配置逻辑
├── config-page.js        # 配置页面交互
├── content-script-spa.js # SPA内容脚本（新）
├── test-fullscreen.html  # 功能测试页面（新）
└── images/               # 图标资源
    ├── icon16.png
    ├── icon48.png
    └── icon128.png
```

## API配置说明

扩展程序使用火山引擎提供的AI服务，需要配置以下参数：

- **API密钥**: 火山引擎平台的访问密钥
- **Base URL**: API服务地址（默认：https://ark.cn-beijing.volces.com/api/v3）
- **模型名称**: 使用的具体模型标识（默认：ep-20250509112109-tqptk）

### 配置步骤
1. 访问火山引擎官网注册账号
2. 创建API密钥
3. 获取模型接入点信息
4. 在扩展配置页面填入相关信息

## 隐私安全

- API密钥通过Chrome Storage API安全存储
- 所有配置数据仅在本地保存
- 不会收集或上传用户输入内容
- 草稿数据保存在本地localStorage中

## 开发说明

### 本地开发

1. 修改代码后，在扩展程序页面点击"刷新"按钮重新加载
2. 使用Chrome开发者工具调试弹窗和配置页面
3. 查看`background.js`的控制台输出进行调试

### 错误处理与调试

- **智能错误识别**: 自动识别配置错误、网络错误、API错误
- **详细错误信息**: 显示具体错误原因和解决方案
- **原始响应显示**: 调试用原始API响应内容显示
- **错误详情面板**: 包含错误堆栈和时间戳信息
- **状态缓存**: 错误状态自动保存，便于问题复现

### 调试指南

1. **查看控制台日志**: F12打开开发者工具查看详细日志
2. **检查原始响应**: 界面显示API返回的原始内容
3. **错误详情**: 展开错误详情查看技术信息
4. **网络请求**: Network标签页查看HTTP请求详情
5. **内容提取测试**: 使用`test-fullscreen.html`测试功能

## 更新日志

### v2.1.2 (最新版本)
- 🔧 **修复最小化功能**: 修复最小化后无法恢复（找不到展开按钮）的问题，优化最小化状态的 UI 显示

### v2.1.1
- 🔧 **修复设置面板**: 修复点击设置按钮无反应的问题，优化配置加载逻辑
- 🔧 **UI 文案更新**: 明确复制按钮功能，提示自动粘贴

### v2.1
- 🆕 **全新侧边栏UI**: 800px宽屏设计，左右分栏布局（左侧输入，右侧结果），体验更流畅
- 🆕 **内置设置面板**: 侧边栏顶部增加设置入口，支持直接配置API Key，无需跳转页面
- 🆕 **智能自动填充**: 复制优化结果后，自动填充到网页目标输入框（支持React应用）
- 🔧 **交互优化**: 修复复制反馈提示，优化最小化/展开逻辑
- 🔧 **初始化检查**: 未配置API Key时自动弹出设置引导

### v2.0
- 🆕 **智能内容提取**: 自动识别`div.text___1gPRS`等特定回复内容
- 🆕 **情感和类型分析**: 智能分析提取内容的情感倾向和类型
- 🆕 **个性化回复建议**: 基于分析结果生成针对性回复建议
- 🆕 **键盘快捷键支持**: Ctrl+Enter发送，Ctrl+S保存草稿，Esc关闭
- 🆕 **自动草稿管理**: 每30秒自动保存，支持手动保存和恢复
- 🆕 **响应式界面**: 全屏模式支持，移动设备适配
- 🆕 **SPA页面支持**: 智能检测单页应用URL变化
- 🆕 **测试页面**: 添加功能测试页面用于验证各项功能
- 🔧 **增强的错误处理**: 更详细的内容提取错误信息
- 🔧 **性能优化**: 智能内容分析和建议生成算法

### v1.1
- 🆕 **AI自动语言识别**: 无需手动选择语言，AI智能识别用户问题语言
- 🆕 **增强错误处理**: 详细的错误信息和调试功能
- 🆕 **状态自动缓存**: 输入内容自动保存，刷新页面不丢失
- 🆕 **界面优化**: 配置窗口尺寸增大，操作更舒适
- 🔧 **JSON格式验证**: 智能检测和修复API响应格式问题
- 🔧 **详细日志**: 完整的API请求响应调试信息

### v1.0
- 基础AI回答优化功能
- 中英文双语支持
- 配置管理功能
- 用户界面优化

## 支持与反馈

如有问题或建议，请通过以下方式联系：

- 提交Issue到GitHub仓库
- 邮件联系开发者

## 许可证

本项目采用MIT许可证，详见[LICENSE](LICENSE)文件。

---

**注意**: 使用本扩展程序需要配置有效的火山引擎API密钥。请确保遵守相关服务条款和使用规范。